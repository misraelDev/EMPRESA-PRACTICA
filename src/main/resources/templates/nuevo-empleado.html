<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Nuevo empleado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Nuevo empleado</h2>
        <form th:action="@{/empleado/guardar}" th:object="${empleado}" method="post" novalidate>
            <!-- Campo Nombre -->
            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                <input 
                    type="text" 
                    class="form-control" 
                    id="nombre" 
                    th:field="*{nombre}" 
                    required 
                    minlength="3" 
                    maxlength="25" 
                    pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$" 
                    title="El nombre debe contener solo letras y espacios, y tener entre 3 y 25 caracteres."
                >
                <div class="invalid-feedback">
                    Por favor, introduce un nombre válido (solo letras y espacios, entre 3 y 25 caracteres).
                </div>
            </div>
            
            <!-- Campo Apellido Paterno -->
            <div class="mb-3">
                <label for="appPaterno" class="form-label">Apellido paterno</label>
                <input 
                    type="text" 
                    class="form-control" 
                    id="appPaterno" 
                    th:field="*{appPaterno}" 
                    required 
                    minlength="3" 
                    maxlength="25" 
                    pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$" 
                    title="El apellido debe contener solo letras y espacios, y tener entre 3 y 25 caracteres."
                >
                <div class="invalid-feedback">
                    Por favor, introduce un apellido paterno válido (solo letras y espacios, entre 3 y 25 caracteres).
                </div>
            </div>
            
            <!-- Campo Apellido Materno -->
            <div class="mb-3">
                <label for="appMaterno" class="form-label">Apellido materno</label>
                <input 
                    type="text" 
                    class="form-control" 
                    id="appMaterno" 
                    th:field="*{appMaterno}" 
                    required 
                    minlength="3" 
                    maxlength="25" 
                    pattern="^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$" 
                    title="El apellido debe contener solo letras y espacios, y tener entre 3 y 25 caracteres."
                >
                <div class="invalid-feedback">
                    Por favor, introduce un apellido materno válido (solo letras y espacios, entre 3 y 25 caracteres).
                </div>
            </div>
            
            <!-- Resto de los campos sin cambios -->
            <div class="mb-3">
                <label for="fechaNacimiento" class="form-label">Fecha de nacimiento</label>
                <input 
                    type="date" 
                    class="form-control" 
                    id="fechaNacimiento" 
                    th:field="*{fechaNacimiento}" 
                    required
                >
                <div class="invalid-feedback">
                    Por favor, selecciona una fecha de nacimiento válida.
                </div>
            </div>
            
            <div class="mb-3">
                <label for="departamento" class="form-label">Departamento</label>
                <select 
                    class="form-control" 
                    id="departamento" 
                    th:field="*{departamento.idDepto}" 
                    required
                >
                    <option value="">Seleccione un departamento</option>
                    <option th:each="depto : ${departamentos}" 
                            th:value="${depto.idDepto}" 
                            th:text="${depto.nombre}">
                    </option>
                </select>
                <div class="invalid-feedback">
                    Por favor, selecciona un departamento.
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary">Guardar</button>
            <a href="/" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Función para bloquear números
            function bloquearNumeros(event) {
                if (/\d/.test(event.key)) {
                    event.preventDefault();
                    return false;
                }
            }

            // Aplicar el bloqueo de números a los campos de nombre y apellidos
            const camposTexto = ['nombre', 'appPaterno', 'appMaterno'];
            camposTexto.forEach(campo => {
                const input = document.getElementById(campo);
                input.addEventListener('keypress', bloquearNumeros);
                // Prevenir pegar contenido con números
                input.addEventListener('paste', (event) => {
                    const texto = (event.clipboardData || window.clipboardData).getData('text');
                    if (/\d/.test(texto)) {
                        event.preventDefault();
                    }
                });
            });

            const inputs = document.querySelectorAll('input, select');

            inputs.forEach(input => {
                // Validación al salir del campo (blur)
                input.addEventListener('blur', () => {
                    if (!input.checkValidity()) {
                        input.classList.add('is-invalid');
                        input.classList.remove('is-valid');
                    } else {
                        input.classList.add('is-valid');
                        input.classList.remove('is-invalid');
                    }
                });

                // Validación en tiempo real (input)
                input.addEventListener('input', () => {
                    if (!input.checkValidity()) {
                        input.classList.add('is-invalid');
                        input.classList.remove('is-valid');
                    } else {
                        input.classList.add('is-valid');
                        input.classList.remove('is-invalid');
                    }
                });
            });

            // Validación al enviar el formulario
            const form = document.querySelector('form');
            form.addEventListener('submit', (event) => {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add('was-validated');
            });
        });
    </script>
</body>
</html>